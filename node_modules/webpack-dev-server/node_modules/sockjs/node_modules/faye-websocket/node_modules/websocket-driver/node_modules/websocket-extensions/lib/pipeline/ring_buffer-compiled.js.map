{"version":3,"sources":["ring_buffer.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,aAAa,UAAS,UAAT,EAAqB;AACpC,OAAK,OAAL,GAAmB,IAAI,KAAJ,CAAU,UAAV,CAAnB;AACA,OAAK,WAAL,GAAmB,UAAnB;AACA,OAAK,WAAL,GAAmB,CAAnB;AACA,OAAK,SAAL,GAAmB,UAAnB;AACA,OAAK,KAAL,GAAmB,CAAnB;AACA,OAAK,KAAL,GAAmB,CAAnB;AACA,OAAK,MAAL,GAAmB,CAAnB;AACD,CARD;;AAUA,WAAW,SAAX,CAAqB,IAArB,GAA4B,UAAS,KAAT,EAAgB;AAC1C,MAAI,eAAe,KAAnB;MACI,aAAe,KADnB;;AAGA,MAAI,KAAK,SAAL,GAAiB,KAAK,WAA1B,EAAuC;AACrC,mBAAgB,KAAK,KAAL,KAAe,CAA/B;AACD,GAFD,MAEO,IAAI,KAAK,WAAL,KAAqB,KAAK,SAA9B,EAAyC;AAC9C,mBAAe,IAAf;AACA,iBAAgB,KAAK,KAAL,KAAe,CAA/B;AACD;;AAED,MAAI,YAAJ,EAAkB;AAChB,SAAK,KAAL,GAAmB,KAAK,WAAxB;AACA,SAAK,OAAL,GAAmB,KAAK,OAAL,CAAa,MAAb,CAAoB,IAAI,KAAJ,CAAU,KAAK,WAAf,CAApB,CAAnB;AACA,SAAK,WAAL,GAAmB,KAAK,OAAL,CAAa,MAAhC;;AAEA,QAAI,UAAJ,EACE,KAAK,SAAL,GAAiB,KAAK,WAAtB;AACH;;AAED,OAAK,OAAL,CAAa,KAAK,KAAlB,IAA2B,KAA3B;AACA,OAAK,MAAL,IAAe,CAAf;AACA,MAAI,KAAK,KAAL,GAAa,KAAK,SAAtB,EAAiC,KAAK,WAAL,IAAoB,CAApB;AACjC,OAAK,KAAL,GAAa,CAAC,KAAK,KAAL,GAAa,CAAd,IAAmB,KAAK,WAArC;AACD,CAxBD;;AA0BA,WAAW,SAAX,CAAqB,IAArB,GAA4B,YAAW;AACrC,MAAI,KAAK,MAAL,KAAgB,CAApB,EAAuB,OAAO,KAAK,CAAZ;AACvB,SAAO,KAAK,OAAL,CAAa,KAAK,KAAlB,CAAP;AACD,CAHD;;AAKA,WAAW,SAAX,CAAqB,KAArB,GAA6B,YAAW;AACtC,MAAI,KAAK,MAAL,KAAgB,CAApB,EAAuB,OAAO,KAAK,CAAZ;;AAEvB,MAAI,QAAQ,KAAK,OAAL,CAAa,KAAK,KAAlB,CAAZ;AACA,OAAK,OAAL,CAAa,KAAK,KAAlB,IAA2B,KAAK,CAAhC;AACA,OAAK,MAAL,IAAe,CAAf;AACA,OAAK,WAAL,IAAoB,CAApB;;AAEA,MAAI,KAAK,WAAL,KAAqB,CAArB,IAA0B,KAAK,MAAL,GAAc,CAA5C,EAA+C;AAC7C,SAAK,KAAL,GAAmB,KAAK,SAAxB;AACA,SAAK,WAAL,GAAmB,KAAK,MAAxB;AACA,SAAK,SAAL,GAAmB,KAAK,WAAxB;AACD,GAJD,MAIO;AACL,SAAK,KAAL,GAAa,CAAC,KAAK,KAAL,GAAa,CAAd,IAAmB,KAAK,SAArC;AACD;AACD,SAAO,KAAP;AACD,CAhBD;;AAkBA,OAAO,OAAP,GAAiB,UAAjB","file":"ring_buffer-compiled.js","sourcesContent":["'use strict';\n\nvar RingBuffer = function(bufferSize) {\n  this._buffer     = new Array(bufferSize);\n  this._bufferSize = bufferSize;\n  this._ringOffset = 0;\n  this._ringSize   = bufferSize;\n  this._head       = 0;\n  this._tail       = 0;\n  this.length      = 0;\n};\n\nRingBuffer.prototype.push = function(value) {\n  var expandBuffer = false,\n      expandRing   = false;\n\n  if (this._ringSize < this._bufferSize) {\n    expandBuffer = (this._tail === 0);\n  } else if (this._ringOffset === this._ringSize) {\n    expandBuffer = true;\n    expandRing   = (this._tail === 0);\n  }\n\n  if (expandBuffer) {\n    this._tail       = this._bufferSize;\n    this._buffer     = this._buffer.concat(new Array(this._bufferSize));\n    this._bufferSize = this._buffer.length;\n\n    if (expandRing)\n      this._ringSize = this._bufferSize;\n  }\n\n  this._buffer[this._tail] = value;\n  this.length += 1;\n  if (this._tail < this._ringSize) this._ringOffset += 1;\n  this._tail = (this._tail + 1) % this._bufferSize;\n};\n\nRingBuffer.prototype.peek = function() {\n  if (this.length === 0) return void 0;\n  return this._buffer[this._head];\n};\n\nRingBuffer.prototype.shift = function() {\n  if (this.length === 0) return void 0;\n\n  var value = this._buffer[this._head];\n  this._buffer[this._head] = void 0;\n  this.length -= 1;\n  this._ringOffset -= 1;\n\n  if (this._ringOffset === 0 && this.length > 0) {\n    this._head       = this._ringSize;\n    this._ringOffset = this.length;\n    this._ringSize   = this._bufferSize;\n  } else {\n    this._head = (this._head + 1) % this._ringSize;\n  }\n  return value;\n};\n\nmodule.exports = RingBuffer;\n"]}