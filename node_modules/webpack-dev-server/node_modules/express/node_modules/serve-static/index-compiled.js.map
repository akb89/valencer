{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["/*!\n * serve-static\n * Copyright(c) 2010 Sencha Inc.\n * Copyright(c) 2011 TJ Holowaychuk\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar escapeHtml = require('escape-html')\nvar parseUrl = require('parseurl')\nvar resolve = require('path').resolve\nvar send = require('send')\nvar url = require('url')\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = serveStatic\nmodule.exports.mime = send.mime\n\n/**\n * @param {string} root\n * @param {object} [options]\n * @return {function}\n * @public\n */\n\nfunction serveStatic (root, options) {\n  if (!root) {\n    throw new TypeError('root path required')\n  }\n\n  if (typeof root !== 'string') {\n    throw new TypeError('root path must be a string')\n  }\n\n  // copy options object\n  var opts = Object.create(options || null)\n\n  // fall-though\n  var fallthrough = opts.fallthrough !== false\n\n  // default redirect\n  var redirect = opts.redirect !== false\n\n  // headers listener\n  var setHeaders = opts.setHeaders\n\n  if (setHeaders && typeof setHeaders !== 'function') {\n    throw new TypeError('option setHeaders must be function')\n  }\n\n  // setup options for send\n  opts.maxage = opts.maxage || opts.maxAge || 0\n  opts.root = resolve(root)\n\n  // construct directory listener\n  var onDirectory = redirect\n    ? createRedirectDirectoryListener()\n    : createNotFoundDirectoryListener()\n\n  return function serveStatic (req, res, next) {\n    if (req.method !== 'GET' && req.method !== 'HEAD') {\n      if (fallthrough) {\n        return next()\n      }\n\n      // method not allowed\n      res.statusCode = 405\n      res.setHeader('Allow', 'GET, HEAD')\n      res.setHeader('Content-Length', '0')\n      res.end()\n      return\n    }\n\n    var forwardError = !fallthrough\n    var originalUrl = parseUrl.original(req)\n    var path = parseUrl(req).pathname\n\n    // make sure redirect occurs at mount\n    if (path === '/' && originalUrl.pathname.substr(-1) !== '/') {\n      path = ''\n    }\n\n    // create send stream\n    var stream = send(req, path, opts)\n\n    // add directory handler\n    stream.on('directory', onDirectory)\n\n    // add headers listener\n    if (setHeaders) {\n      stream.on('headers', setHeaders)\n    }\n\n    // add file listener for fallthrough\n    if (fallthrough) {\n      stream.on('file', function onFile () {\n        // once file is determined, always forward error\n        forwardError = true\n      })\n    }\n\n    // forward errors\n    stream.on('error', function error (err) {\n      if (forwardError || !(err.statusCode < 500)) {\n        next(err)\n        return\n      }\n\n      next()\n    })\n\n    // pipe\n    stream.pipe(res)\n  }\n}\n\n/**\n * Collapse all leading slashes into a single slash\n * @private\n */\nfunction collapseLeadingSlashes (str) {\n  for (var i = 0; i < str.length; i++) {\n    if (str[i] !== '/') {\n      break\n    }\n  }\n\n  return i > 1\n    ? '/' + str.substr(i)\n    : str\n}\n\n/**\n * Create a directory listener that just 404s.\n * @private\n */\n\nfunction createNotFoundDirectoryListener () {\n  return function notFound () {\n    this.error(404)\n  }\n}\n\n/**\n * Create a directory listener that performs a redirect.\n * @private\n */\n\nfunction createRedirectDirectoryListener () {\n  return function redirect () {\n    if (this.hasTrailingSlash()) {\n      this.error(404)\n      return\n    }\n\n    // get original URL\n    var originalUrl = parseUrl.original(this.req)\n\n    // append trailing slash\n    originalUrl.path = null\n    originalUrl.pathname = collapseLeadingSlashes(originalUrl.pathname + '/')\n\n    // reformat the URL\n    var loc = url.format(originalUrl)\n    var msg = 'Redirecting to <a href=\"' + escapeHtml(loc) + '\">' + escapeHtml(loc) + '</a>\\n'\n    var res = this.res\n\n    // send redirect response\n    res.statusCode = 303\n    res.setHeader('Content-Type', 'text/html; charset=UTF-8')\n    res.setHeader('Content-Length', Buffer.byteLength(msg))\n    res.setHeader('X-Content-Type-Options', 'nosniff')\n    res.setHeader('Location', loc)\n    res.end(msg)\n  }\n}\n"]}