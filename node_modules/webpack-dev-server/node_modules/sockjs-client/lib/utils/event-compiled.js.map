{"version":3,"sources":["event.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,SAAS,QAAQ,UAAR,CAAb;;AAEA,IAAI,WAAW,EAAf;IACI,cAAc;;AADlB;IAGI,sBAAsB,OAAO,MAAP,IAAiB,OAAO,MAAP,CAAc,GAA/B,IAAsC,OAAO,MAAP,CAAc,GAAd,CAAkB,OAHlF;;AAMA,OAAO,OAAP,GAAiB;AACf,eAAa,UAAS,KAAT,EAAgB,QAAhB,EAA0B;AACrC,QAAI,OAAO,OAAO,gBAAd,KAAmC,WAAvC,EAAoD;AAClD,aAAO,gBAAP,CAAwB,KAAxB,EAA+B,QAA/B,EAAyC,KAAzC;AACD,KAFD,MAEO,IAAI,OAAO,QAAP,IAAmB,OAAO,WAA9B,EAA2C;;;;AAIhD,aAAO,QAAP,CAAgB,WAAhB,CAA4B,OAAO,KAAnC,EAA0C,QAA1C;;AAEA,aAAO,WAAP,CAAmB,OAAO,KAA1B,EAAiC,QAAjC;AACD;AACF,GAZc;;AAcf,eAAa,UAAS,KAAT,EAAgB,QAAhB,EAA0B;AACrC,QAAI,OAAO,OAAO,gBAAd,KAAmC,WAAvC,EAAoD;AAClD,aAAO,mBAAP,CAA2B,KAA3B,EAAkC,QAAlC,EAA4C,KAA5C;AACD,KAFD,MAEO,IAAI,OAAO,QAAP,IAAmB,OAAO,WAA9B,EAA2C;AAChD,aAAO,QAAP,CAAgB,WAAhB,CAA4B,OAAO,KAAnC,EAA0C,QAA1C;AACA,aAAO,WAAP,CAAmB,OAAO,KAA1B,EAAiC,QAAjC;AACD;AACF,GArBc;;AAuBf,aAAW,UAAS,QAAT,EAAmB;AAC5B,QAAI,mBAAJ,EAAyB;AACvB,aAAO,IAAP;AACD;;AAED,QAAI,MAAM,OAAO,MAAP,CAAc,CAAd,CAAV;AACA,aAAS,GAAT,IAAgB,QAAhB;AACA,QAAI,WAAJ,EAAiB;AACf,iBAAW,KAAK,sBAAhB,EAAwC,CAAxC;AACD;AACD,WAAO,GAAP;AACD,GAlCc;;AAoCf,aAAW,UAAS,GAAT,EAAc;AACvB,QAAI,OAAO,QAAX,EAAqB;AACnB,aAAO,SAAS,GAAT,CAAP;AACD;AACF,GAxCc;;AA0Cf,0BAAwB,YAAW;AACjC,SAAK,IAAI,GAAT,IAAgB,QAAhB,EAA0B;AACxB,eAAS,GAAT;AACA,aAAO,SAAS,GAAT,CAAP;AACD;AACF;AA/Cc,CAAjB;;AAkDA,IAAI,kBAAkB,YAAW;AAC/B,MAAI,WAAJ,EAAiB;AACf;AACD;AACD,gBAAc,IAAd;AACA,SAAO,OAAP,CAAe,sBAAf;AACD,CAND;;;;AAUA,IAAI,CAAC,mBAAL,EAA0B;AACxB,SAAO,OAAP,CAAe,WAAf,CAA2B,QAA3B,EAAqC,eAArC;AACD","file":"event-compiled.js","sourcesContent":["'use strict';\n\nvar random = require('./random');\n\nvar onUnload = {}\n  , afterUnload = false\n    // detect google chrome packaged apps because they don't allow the 'unload' event\n  , isChromePackagedApp = global.chrome && global.chrome.app && global.chrome.app.runtime\n  ;\n\nmodule.exports = {\n  attachEvent: function(event, listener) {\n    if (typeof global.addEventListener !== 'undefined') {\n      global.addEventListener(event, listener, false);\n    } else if (global.document && global.attachEvent) {\n      // IE quirks.\n      // According to: http://stevesouders.com/misc/test-postmessage.php\n      // the message gets delivered only to 'document', not 'window'.\n      global.document.attachEvent('on' + event, listener);\n      // I get 'window' for ie8.\n      global.attachEvent('on' + event, listener);\n    }\n  }\n\n, detachEvent: function(event, listener) {\n    if (typeof global.addEventListener !== 'undefined') {\n      global.removeEventListener(event, listener, false);\n    } else if (global.document && global.detachEvent) {\n      global.document.detachEvent('on' + event, listener);\n      global.detachEvent('on' + event, listener);\n    }\n  }\n\n, unloadAdd: function(listener) {\n    if (isChromePackagedApp) {\n      return null;\n    }\n\n    var ref = random.string(8);\n    onUnload[ref] = listener;\n    if (afterUnload) {\n      setTimeout(this.triggerUnloadCallbacks, 0);\n    }\n    return ref;\n  }\n\n, unloadDel: function(ref) {\n    if (ref in onUnload) {\n      delete onUnload[ref];\n    }\n  }\n\n, triggerUnloadCallbacks: function() {\n    for (var ref in onUnload) {\n      onUnload[ref]();\n      delete onUnload[ref];\n    }\n  }\n};\n\nvar unloadTriggered = function() {\n  if (afterUnload) {\n    return;\n  }\n  afterUnload = true;\n  module.exports.triggerUnloadCallbacks();\n};\n\n// 'unload' alone is not reliable in opera within an iframe, but we\n// can't use `beforeunload` as IE fires it on javascript: links.\nif (!isChromePackagedApp) {\n  module.exports.attachEvent('unload', unloadTriggered);\n}\n"]}