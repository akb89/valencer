{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index-compiled.js","sourcesContent":["'use strict';\n\nvar PENDING = 'pending';\nvar SETTLED = 'settled';\nvar FULFILLED = 'fulfilled';\nvar REJECTED = 'rejected';\nvar NOOP = function () {};\nvar isNode = typeof global !== 'undefined' && typeof global.process !== 'undefined' && typeof global.process.emit === 'function';\n\nvar asyncSetTimer = typeof setImmediate === 'undefined' ? setTimeout : setImmediate;\nvar asyncQueue = [];\nvar asyncTimer;\n\nfunction asyncFlush() {\n\t// run promise callbacks\n\tfor (var i = 0; i < asyncQueue.length; i++) {\n\t\tasyncQueue[i][0](asyncQueue[i][1]);\n\t}\n\n\t// reset async asyncQueue\n\tasyncQueue = [];\n\tasyncTimer = false;\n}\n\nfunction asyncCall(callback, arg) {\n\tasyncQueue.push([callback, arg]);\n\n\tif (!asyncTimer) {\n\t\tasyncTimer = true;\n\t\tasyncSetTimer(asyncFlush, 0);\n\t}\n}\n\nfunction invokeResolver(resolver, promise) {\n\tfunction resolvePromise(value) {\n\t\tresolve(promise, value);\n\t}\n\n\tfunction rejectPromise(reason) {\n\t\treject(promise, reason);\n\t}\n\n\ttry {\n\t\tresolver(resolvePromise, rejectPromise);\n\t} catch (e) {\n\t\trejectPromise(e);\n\t}\n}\n\nfunction invokeCallback(subscriber) {\n\tvar owner = subscriber.owner;\n\tvar settled = owner._state;\n\tvar value = owner._data;\n\tvar callback = subscriber[settled];\n\tvar promise = subscriber.then;\n\n\tif (typeof callback === 'function') {\n\t\tsettled = FULFILLED;\n\t\ttry {\n\t\t\tvalue = callback(value);\n\t\t} catch (e) {\n\t\t\treject(promise, e);\n\t\t}\n\t}\n\n\tif (!handleThenable(promise, value)) {\n\t\tif (settled === FULFILLED) {\n\t\t\tresolve(promise, value);\n\t\t}\n\n\t\tif (settled === REJECTED) {\n\t\t\treject(promise, value);\n\t\t}\n\t}\n}\n\nfunction handleThenable(promise, value) {\n\tvar resolved;\n\n\ttry {\n\t\tif (promise === value) {\n\t\t\tthrow new TypeError('A promises callback cannot return that same promise.');\n\t\t}\n\n\t\tif (value && (typeof value === 'function' || typeof value === 'object')) {\n\t\t\t// then should be retrieved only once\n\t\t\tvar then = value.then;\n\n\t\t\tif (typeof then === 'function') {\n\t\t\t\tthen.call(value, function (val) {\n\t\t\t\t\tif (!resolved) {\n\t\t\t\t\t\tresolved = true;\n\n\t\t\t\t\t\tif (value === val) {\n\t\t\t\t\t\t\tfulfill(promise, val);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(promise, val);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, function (reason) {\n\t\t\t\t\tif (!resolved) {\n\t\t\t\t\t\tresolved = true;\n\n\t\t\t\t\t\treject(promise, reason);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t} catch (e) {\n\t\tif (!resolved) {\n\t\t\treject(promise, e);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nfunction resolve(promise, value) {\n\tif (promise === value || !handleThenable(promise, value)) {\n\t\tfulfill(promise, value);\n\t}\n}\n\nfunction fulfill(promise, value) {\n\tif (promise._state === PENDING) {\n\t\tpromise._state = SETTLED;\n\t\tpromise._data = value;\n\n\t\tasyncCall(publishFulfillment, promise);\n\t}\n}\n\nfunction reject(promise, reason) {\n\tif (promise._state === PENDING) {\n\t\tpromise._state = SETTLED;\n\t\tpromise._data = reason;\n\n\t\tasyncCall(publishRejection, promise);\n\t}\n}\n\nfunction publish(promise) {\n\tpromise._then = promise._then.forEach(invokeCallback);\n}\n\nfunction publishFulfillment(promise) {\n\tpromise._state = FULFILLED;\n\tpublish(promise);\n}\n\nfunction publishRejection(promise) {\n\tpromise._state = REJECTED;\n\tpublish(promise);\n\tif (!promise._handled && isNode) {\n\t\tglobal.process.emit('unhandledRejection', promise._data, promise);\n\t}\n}\n\nfunction notifyRejectionHandled(promise) {\n\tglobal.process.emit('rejectionHandled', promise);\n}\n\n/**\n * @class\n */\nfunction Promise(resolver) {\n\tif (typeof resolver !== 'function') {\n\t\tthrow new TypeError('Promise resolver ' + resolver + ' is not a function');\n\t}\n\n\tif (this instanceof Promise === false) {\n\t\tthrow new TypeError('Failed to construct \\'Promise\\': Please use the \\'new\\' operator, this object constructor cannot be called as a function.');\n\t}\n\n\tthis._then = [];\n\n\tinvokeResolver(resolver, this);\n}\n\nPromise.prototype = {\n\tconstructor: Promise,\n\n\t_state: PENDING,\n\t_then: null,\n\t_data: undefined,\n\t_handled: false,\n\n\tthen: function (onFulfillment, onRejection) {\n\t\tvar subscriber = {\n\t\t\towner: this,\n\t\t\tthen: new this.constructor(NOOP),\n\t\t\tfulfilled: onFulfillment,\n\t\t\trejected: onRejection\n\t\t};\n\n\t\tif ((onRejection || onFulfillment) && !this._handled) {\n\t\t\tthis._handled = true;\n\t\t\tif (this._state === REJECTED && isNode) {\n\t\t\t\tasyncCall(notifyRejectionHandled, this);\n\t\t\t}\n\t\t}\n\n\t\tif (this._state === FULFILLED || this._state === REJECTED) {\n\t\t\t// already resolved, call callback async\n\t\t\tasyncCall(invokeCallback, subscriber);\n\t\t} else {\n\t\t\t// subscribe\n\t\t\tthis._then.push(subscriber);\n\t\t}\n\n\t\treturn subscriber.then;\n\t},\n\n\tcatch: function (onRejection) {\n\t\treturn this.then(null, onRejection);\n\t}\n};\n\nPromise.all = function (promises) {\n\tif (!Array.isArray(promises)) {\n\t\tthrow new TypeError('You must pass an array to Promise.all().');\n\t}\n\n\treturn new Promise(function (resolve, reject) {\n\t\tvar results = [];\n\t\tvar remaining = 0;\n\n\t\tfunction resolver(index) {\n\t\t\tremaining++;\n\t\t\treturn function (value) {\n\t\t\t\tresults[index] = value;\n\t\t\t\tif (!--remaining) {\n\t\t\t\t\tresolve(results);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tfor (var i = 0, promise; i < promises.length; i++) {\n\t\t\tpromise = promises[i];\n\n\t\t\tif (promise && typeof promise.then === 'function') {\n\t\t\t\tpromise.then(resolver(i), reject);\n\t\t\t} else {\n\t\t\t\tresults[i] = promise;\n\t\t\t}\n\t\t}\n\n\t\tif (!remaining) {\n\t\t\tresolve(results);\n\t\t}\n\t});\n};\n\nPromise.race = function (promises) {\n\tif (!Array.isArray(promises)) {\n\t\tthrow new TypeError('You must pass an array to Promise.race().');\n\t}\n\n\treturn new Promise(function (resolve, reject) {\n\t\tfor (var i = 0, promise; i < promises.length; i++) {\n\t\t\tpromise = promises[i];\n\n\t\t\tif (promise && typeof promise.then === 'function') {\n\t\t\t\tpromise.then(resolve, reject);\n\t\t\t} else {\n\t\t\t\tresolve(promise);\n\t\t\t}\n\t\t}\n\t});\n};\n\nPromise.resolve = function (value) {\n\tif (value && typeof value === 'object' && value.constructor === Promise) {\n\t\treturn value;\n\t}\n\n\treturn new Promise(function (resolve) {\n\t\tresolve(value);\n\t});\n};\n\nPromise.reject = function (reason) {\n\treturn new Promise(function (resolve, reject) {\n\t\treject(reason);\n\t});\n};\n\nmodule.exports = Promise;\n"]}