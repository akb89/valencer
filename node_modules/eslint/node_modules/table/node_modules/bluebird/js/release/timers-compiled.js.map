{"version":3,"sources":["timers.js"],"names":[],"mappings":"AAAA;;AACA,OAAO,OAAP,GAAiB,UAAS,OAAT,EAAkB,QAAlB,EAA4B,KAA5B,EAAmC;AACpD,QAAI,OAAO,QAAQ,QAAR,CAAX;AACA,QAAI,eAAe,QAAQ,YAA3B;;AAEA,aAAS,aAAT,CAAuB,MAAvB,EAAgC;AAC5B,aAAK,MAAL,GAAc,MAAd;AACH;;AAED,kBAAc,SAAd,CAAwB,gBAAxB,GAA2C,YAAW;AAClD,qBAAa,KAAK,MAAlB;AACH,KAFD;;AAIA,QAAI,aAAa,SAAb,UAAa,CAAS,KAAT,EAAgB;AAAE,eAAO,MAAM,CAAC,IAAP,EAAa,UAAb,CAAwB,KAAxB,CAAP;AAAwC,KAA3E;AACA,QAAI,QAAQ,QAAQ,KAAR,GAAgB,UAAU,EAAV,EAAc,KAAd,EAAqB;AAC7C,YAAI,GAAJ;AACA,YAAI,MAAJ;AACA,YAAI,UAAU,SAAd,EAAyB;AACrB,kBAAM,QAAQ,OAAR,CAAgB,KAAhB,EACG,KADH,CACS,UADT,EACqB,IADrB,EAC2B,IAD3B,EACiC,EADjC,EACqC,SADrC,CAAN;AAEA,gBAAI,MAAM,YAAN,MAAwB,iBAAiB,OAA7C,EAAsD;AAClD,oBAAI,YAAJ,CAAiB,KAAjB;AACH;AACJ,SAND,MAMO;AACH,kBAAM,IAAI,OAAJ,CAAY,QAAZ,CAAN;AACA,qBAAS,WAAW,YAAW;AAAE,oBAAI,QAAJ;AAAiB,aAAzC,EAA2C,CAAC,EAA5C,CAAT;AACA,gBAAI,MAAM,YAAN,EAAJ,EAA0B;AACtB,oBAAI,YAAJ,CAAiB,IAAI,aAAJ,CAAkB,MAAlB,CAAjB;AACH;AACJ;AACD,YAAI,mBAAJ;AACA,eAAO,GAAP;AACH,KAlBD;;AAoBA,YAAQ,SAAR,CAAkB,KAAlB,GAA0B,UAAU,EAAV,EAAc;AACpC,eAAO,MAAM,EAAN,EAAU,IAAV,CAAP;AACH,KAFD;;AAIA,QAAI,eAAe,SAAf,YAAe,CAAU,OAAV,EAAmB,OAAnB,EAA4B,MAA5B,EAAoC;AACnD,YAAI,GAAJ;AACA,YAAI,OAAO,OAAP,KAAmB,QAAvB,EAAiC;AAC7B,gBAAI,mBAAmB,KAAvB,EAA8B;AAC1B,sBAAM,OAAN;AACH,aAFD,MAEO;AACH,sBAAM,IAAI,YAAJ,CAAiB,qBAAjB,CAAN;AACH;AACJ,SAND,MAMO;AACH,kBAAM,IAAI,YAAJ,CAAiB,OAAjB,CAAN;AACH;AACD,aAAK,8BAAL,CAAoC,GAApC;AACA,gBAAQ,iBAAR,CAA0B,GAA1B;AACA,gBAAQ,OAAR,CAAgB,GAAhB;;AAEA,YAAI,UAAU,IAAd,EAAoB;AAChB,mBAAO,MAAP;AACH;AACJ,KAlBD;;AAoBA,aAAS,YAAT,CAAsB,KAAtB,EAA6B;AACzB,qBAAa,KAAK,MAAlB;AACA,eAAO,KAAP;AACH;;AAED,aAAS,YAAT,CAAsB,MAAtB,EAA8B;AAC1B,qBAAa,KAAK,MAAlB;AACA,cAAM,MAAN;AACH;;AAED,YAAQ,SAAR,CAAkB,OAAlB,GAA4B,UAAU,EAAV,EAAc,OAAd,EAAuB;AAC/C,aAAK,CAAC,EAAN;AACA,YAAI,GAAJ,EAAS,MAAT;;AAEA,YAAI,gBAAgB,IAAI,aAAJ,CAAkB,WAAW,SAAS,cAAT,GAA0B;AACvE,gBAAI,IAAI,SAAJ,EAAJ,EAAqB;AACjB,6BAAa,GAAb,EAAkB,OAAlB,EAA2B,MAA3B;AACH;AACJ,SAJqC,EAInC,EAJmC,CAAlB,CAApB;;AAMA,YAAI,MAAM,YAAN,EAAJ,EAA0B;AACtB,qBAAS,KAAK,IAAL,EAAT;AACA,kBAAM,OAAO,KAAP,CAAa,YAAb,EAA2B,YAA3B,EACc,SADd,EACyB,aADzB,EACwC,SADxC,CAAN;AAEA,gBAAI,YAAJ,CAAiB,aAAjB;AACH,SALD,MAKO;AACH,kBAAM,KAAK,KAAL,CAAW,YAAX,EAAyB,YAAzB,EACc,SADd,EACyB,aADzB,EACwC,SADxC,CAAN;AAEH;;AAED,eAAO,GAAP;AACH,KArBD;AAuBC,CA1FD","file":"timers-compiled.js","sourcesContent":["\"use strict\";\nmodule.exports = function(Promise, INTERNAL, debug) {\nvar util = require(\"./util\");\nvar TimeoutError = Promise.TimeoutError;\n\nfunction HandleWrapper(handle)  {\n    this.handle = handle;\n}\n\nHandleWrapper.prototype._resultCancelled = function() {\n    clearTimeout(this.handle);\n};\n\nvar afterValue = function(value) { return delay(+this).thenReturn(value); };\nvar delay = Promise.delay = function (ms, value) {\n    var ret;\n    var handle;\n    if (value !== undefined) {\n        ret = Promise.resolve(value)\n                ._then(afterValue, null, null, ms, undefined);\n        if (debug.cancellation() && value instanceof Promise) {\n            ret._setOnCancel(value);\n        }\n    } else {\n        ret = new Promise(INTERNAL);\n        handle = setTimeout(function() { ret._fulfill(); }, +ms);\n        if (debug.cancellation()) {\n            ret._setOnCancel(new HandleWrapper(handle));\n        }\n    }\n    ret._setAsyncGuaranteed();\n    return ret;\n};\n\nPromise.prototype.delay = function (ms) {\n    return delay(ms, this);\n};\n\nvar afterTimeout = function (promise, message, parent) {\n    var err;\n    if (typeof message !== \"string\") {\n        if (message instanceof Error) {\n            err = message;\n        } else {\n            err = new TimeoutError(\"operation timed out\");\n        }\n    } else {\n        err = new TimeoutError(message);\n    }\n    util.markAsOriginatingFromRejection(err);\n    promise._attachExtraTrace(err);\n    promise._reject(err);\n\n    if (parent != null) {\n        parent.cancel();\n    }\n};\n\nfunction successClear(value) {\n    clearTimeout(this.handle);\n    return value;\n}\n\nfunction failureClear(reason) {\n    clearTimeout(this.handle);\n    throw reason;\n}\n\nPromise.prototype.timeout = function (ms, message) {\n    ms = +ms;\n    var ret, parent;\n\n    var handleWrapper = new HandleWrapper(setTimeout(function timeoutTimeout() {\n        if (ret.isPending()) {\n            afterTimeout(ret, message, parent);\n        }\n    }, ms));\n\n    if (debug.cancellation()) {\n        parent = this.then();\n        ret = parent._then(successClear, failureClear,\n                            undefined, handleWrapper, undefined);\n        ret._setOnCancel(handleWrapper);\n    } else {\n        ret = this._then(successClear, failureClear,\n                            undefined, handleWrapper, undefined);\n    }\n\n    return ret;\n};\n\n};\n"]}