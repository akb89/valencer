{"version":3,"sources":["generators.js"],"names":[],"mappings":"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","file":"generators-compiled.js","sourcesContent":["\"use strict\";\nmodule.exports = function(Promise,\n                          apiRejection,\n                          INTERNAL,\n                          tryConvertToPromise,\n                          Proxyable,\n                          debug) {\nvar errors = require(\"./errors\");\nvar TypeError = errors.TypeError;\nvar util = require(\"./util\");\nvar errorObj = util.errorObj;\nvar tryCatch = util.tryCatch;\nvar yieldHandlers = [];\n\nfunction promiseFromYieldHandler(value, yieldHandlers, traceParent) {\n    for (var i = 0; i < yieldHandlers.length; ++i) {\n        traceParent._pushContext();\n        var result = tryCatch(yieldHandlers[i])(value);\n        traceParent._popContext();\n        if (result === errorObj) {\n            traceParent._pushContext();\n            var ret = Promise.reject(errorObj.e);\n            traceParent._popContext();\n            return ret;\n        }\n        var maybePromise = tryConvertToPromise(result, traceParent);\n        if (maybePromise instanceof Promise) return maybePromise;\n    }\n    return null;\n}\n\nfunction PromiseSpawn(generatorFunction, receiver, yieldHandler, stack) {\n    if (debug.cancellation()) {\n        var internal = new Promise(INTERNAL);\n        var _finallyPromise = this._finallyPromise = new Promise(INTERNAL);\n        this._promise = internal.lastly(function() {\n            return _finallyPromise;\n        });\n        internal._captureStackTrace();\n        internal._setOnCancel(this);\n    } else {\n        var promise = this._promise = new Promise(INTERNAL);\n        promise._captureStackTrace();\n    }\n    this._stack = stack;\n    this._generatorFunction = generatorFunction;\n    this._receiver = receiver;\n    this._generator = undefined;\n    this._yieldHandlers = typeof yieldHandler === \"function\"\n        ? [yieldHandler].concat(yieldHandlers)\n        : yieldHandlers;\n    this._yieldedPromise = null;\n    this._cancellationPhase = false;\n}\nutil.inherits(PromiseSpawn, Proxyable);\n\nPromiseSpawn.prototype._isResolved = function() {\n    return this._promise === null;\n};\n\nPromiseSpawn.prototype._cleanup = function() {\n    this._promise = this._generator = null;\n    if (debug.cancellation() && this._finallyPromise !== null) {\n        this._finallyPromise._fulfill();\n        this._finallyPromise = null;\n    }\n};\n\nPromiseSpawn.prototype._promiseCancelled = function() {\n    if (this._isResolved()) return;\n    var implementsReturn = typeof this._generator[\"return\"] !== \"undefined\";\n\n    var result;\n    if (!implementsReturn) {\n        var reason = new Promise.CancellationError(\n            \"generator .return() sentinel\");\n        Promise.coroutine.returnSentinel = reason;\n        this._promise._attachExtraTrace(reason);\n        this._promise._pushContext();\n        result = tryCatch(this._generator[\"throw\"]).call(this._generator,\n                                                         reason);\n        this._promise._popContext();\n    } else {\n        this._promise._pushContext();\n        result = tryCatch(this._generator[\"return\"]).call(this._generator,\n                                                          undefined);\n        this._promise._popContext();\n    }\n    this._cancellationPhase = true;\n    this._yieldedPromise = null;\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._promiseFulfilled = function(value) {\n    this._yieldedPromise = null;\n    this._promise._pushContext();\n    var result = tryCatch(this._generator.next).call(this._generator, value);\n    this._promise._popContext();\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._promiseRejected = function(reason) {\n    this._yieldedPromise = null;\n    this._promise._attachExtraTrace(reason);\n    this._promise._pushContext();\n    var result = tryCatch(this._generator[\"throw\"])\n        .call(this._generator, reason);\n    this._promise._popContext();\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._resultCancelled = function() {\n    if (this._yieldedPromise instanceof Promise) {\n        var promise = this._yieldedPromise;\n        this._yieldedPromise = null;\n        promise.cancel();\n    }\n};\n\nPromiseSpawn.prototype.promise = function () {\n    return this._promise;\n};\n\nPromiseSpawn.prototype._run = function () {\n    this._generator = this._generatorFunction.call(this._receiver);\n    this._receiver =\n        this._generatorFunction = undefined;\n    this._promiseFulfilled(undefined);\n};\n\nPromiseSpawn.prototype._continue = function (result) {\n    var promise = this._promise;\n    if (result === errorObj) {\n        this._cleanup();\n        if (this._cancellationPhase) {\n            return promise.cancel();\n        } else {\n            return promise._rejectCallback(result.e, false);\n        }\n    }\n\n    var value = result.value;\n    if (result.done === true) {\n        this._cleanup();\n        if (this._cancellationPhase) {\n            return promise.cancel();\n        } else {\n            return promise._resolveCallback(value);\n        }\n    } else {\n        var maybePromise = tryConvertToPromise(value, this._promise);\n        if (!(maybePromise instanceof Promise)) {\n            maybePromise =\n                promiseFromYieldHandler(maybePromise,\n                                        this._yieldHandlers,\n                                        this._promise);\n            if (maybePromise === null) {\n                this._promiseRejected(\n                    new TypeError(\n                        \"A value %s was yielded that could not be treated as a promise\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\\u000a\".replace(\"%s\", value) +\n                        \"From coroutine:\\u000a\" +\n                        this._stack.split(\"\\n\").slice(1, -7).join(\"\\n\")\n                    )\n                );\n                return;\n            }\n        }\n        maybePromise = maybePromise._target();\n        var bitField = maybePromise._bitField;\n        ;\n        if (((bitField & 50397184) === 0)) {\n            this._yieldedPromise = maybePromise;\n            maybePromise._proxy(this, null);\n        } else if (((bitField & 33554432) !== 0)) {\n            this._promiseFulfilled(maybePromise._value());\n        } else if (((bitField & 16777216) !== 0)) {\n            this._promiseRejected(maybePromise._reason());\n        } else {\n            this._promiseCancelled();\n        }\n    }\n};\n\nPromise.coroutine = function (generatorFunction, options) {\n    if (typeof generatorFunction !== \"function\") {\n        throw new TypeError(\"generatorFunction must be a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var yieldHandler = Object(options).yieldHandler;\n    var PromiseSpawn$ = PromiseSpawn;\n    var stack = new Error().stack;\n    return function () {\n        var generator = generatorFunction.apply(this, arguments);\n        var spawn = new PromiseSpawn$(undefined, undefined, yieldHandler,\n                                      stack);\n        var ret = spawn.promise();\n        spawn._generator = generator;\n        spawn._promiseFulfilled(undefined);\n        return ret;\n    };\n};\n\nPromise.coroutine.addYieldHandler = function(fn) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    yieldHandlers.push(fn);\n};\n\nPromise.spawn = function (generatorFunction) {\n    debug.deprecated(\"Promise.spawn()\", \"Promise.coroutine()\");\n    if (typeof generatorFunction !== \"function\") {\n        return apiRejection(\"generatorFunction must be a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var spawn = new PromiseSpawn(generatorFunction, this);\n    var ret = spawn.promise();\n    spawn._run(Promise.spawn);\n    return ret;\n};\n};\n"]}