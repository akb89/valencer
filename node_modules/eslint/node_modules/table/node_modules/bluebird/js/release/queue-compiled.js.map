{"version":3,"sources":["queue.js"],"names":[],"mappings":"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","file":"queue-compiled.js","sourcesContent":["\"use strict\";\nfunction arrayMove(src, srcIndex, dst, dstIndex, len) {\n    for (var j = 0; j < len; ++j) {\n        dst[j + dstIndex] = src[j + srcIndex];\n        src[j + srcIndex] = void 0;\n    }\n}\n\nfunction Queue(capacity) {\n    this._capacity = capacity;\n    this._length = 0;\n    this._front = 0;\n}\n\nQueue.prototype._willBeOverCapacity = function (size) {\n    return this._capacity < size;\n};\n\nQueue.prototype._pushOne = function (arg) {\n    var length = this.length();\n    this._checkCapacity(length + 1);\n    var i = (this._front + length) & (this._capacity - 1);\n    this[i] = arg;\n    this._length = length + 1;\n};\n\nQueue.prototype._unshiftOne = function(value) {\n    var capacity = this._capacity;\n    this._checkCapacity(this.length() + 1);\n    var front = this._front;\n    var i = (((( front - 1 ) &\n                    ( capacity - 1) ) ^ capacity ) - capacity );\n    this[i] = value;\n    this._front = i;\n    this._length = this.length() + 1;\n};\n\nQueue.prototype.unshift = function(fn, receiver, arg) {\n    this._unshiftOne(arg);\n    this._unshiftOne(receiver);\n    this._unshiftOne(fn);\n};\n\nQueue.prototype.push = function (fn, receiver, arg) {\n    var length = this.length() + 3;\n    if (this._willBeOverCapacity(length)) {\n        this._pushOne(fn);\n        this._pushOne(receiver);\n        this._pushOne(arg);\n        return;\n    }\n    var j = this._front + length - 3;\n    this._checkCapacity(length);\n    var wrapMask = this._capacity - 1;\n    this[(j + 0) & wrapMask] = fn;\n    this[(j + 1) & wrapMask] = receiver;\n    this[(j + 2) & wrapMask] = arg;\n    this._length = length;\n};\n\nQueue.prototype.shift = function () {\n    var front = this._front,\n        ret = this[front];\n\n    this[front] = undefined;\n    this._front = (front + 1) & (this._capacity - 1);\n    this._length--;\n    return ret;\n};\n\nQueue.prototype.length = function () {\n    return this._length;\n};\n\nQueue.prototype._checkCapacity = function (size) {\n    if (this._capacity < size) {\n        this._resizeTo(this._capacity << 1);\n    }\n};\n\nQueue.prototype._resizeTo = function (capacity) {\n    var oldCapacity = this._capacity;\n    this._capacity = capacity;\n    var front = this._front;\n    var length = this._length;\n    var moveItemsCount = (front + length) & (oldCapacity - 1);\n    arrayMove(this, 0, this, oldCapacity, moveItemsCount);\n};\n\nmodule.exports = Queue;\n"]}